<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Admin — GeniusNovels</title><link rel="stylesheet" href="style.css"></head><body><header class="header"><div class="container nav"><div class="brand"><div class="logo">G</div><div><h1 style="margin:0">GeniusNovels — Admin</h1></div></div><nav class="menu"><a href="index.html">Public</a><a href="genres.html">Genres</a><a href="about.html">About</a><a id="logoutBtn" class="cta" href="#">Logout</a></nav></div></header><main class="container" style="padding-top:28px;max-width:1100px"><div style="display:flex;gap:20px;flex-wrap:wrap"><div style="flex:1;min-width:320px;background:linear-gradient(180deg,var(--card),#061018);padding:18px;border-radius:12px"><h3>Add / Edit Novel</h3><form id="novelForm" style="margin-top:12px"><div class="form-row"><label class="small">Title</label><input id="title" class="input" required></div><div class="form-row"><label class="small">Genre</label><input id="genre" class="input" required></div><div class="form-row"><label class="small">Pages</label><input id="pages" class="input" type="number" min="1" required></div><div class="form-row"><label class="small">Cover Image URL (or upload below)</label><input id="coverUrl" class="input" placeholder="https://..."></div><div class="form-row"><label class="small">Or Upload Cover Image (jpg/png)</label><input id="coverFile" class="input" type="file" accept="image/*"></div><div class="form-row"><label class="small">Description</label><textarea id="desc" class="input" rows="4"></textarea></div><input type="hidden" id="novelId"><div style="display:flex;gap:8px"><button id="saveBtn" class="btn" type="submit">Save Novel</button><button id="resetBtn" class="btn" type="button" style="background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--muted)">Reset</button></div><div id="formMsg" class="small" style="margin-top:8px;color:var(--muted)"></div></form><hr style="margin:18px 0"><h3>Add Chapter to Novel</h3><form id="chapterForm" style="margin-top:12px"><div class="form-row"><label class="small">Select Novel</label><select id="novelSelect" class="input"></select></div><div class="form-row"><label class="small">Chapter Title</label><input id="chTitle" class="input"></div><div class="form-row"><label class="small">Chapter Content</label><textarea id="chContent" rows="6" class="input"></textarea></div><div style="display:flex;gap:8px"><button id="saveChBtn" class="btn" type="submit">Save Chapter</button></div><div id="chMsg" class="small" style="margin-top:8px;color:var(--muted)"></div></form></div><div style="width:420px;min-width:300px;background:linear-gradient(180deg,var(--card),#061018);padding:18px;border-radius:12px"><h3>Local Novels</h3><div id="adminList" style="margin-top:12px"></div><div style="margin-top:12px;display:flex;gap:8px"><button id="exportBtn" class="btn">Export JSON</button><button id="clearBtn" class="btn" style="background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--muted)">Clear All (local)</button></div><div style="margin-top:8px" class="small">Uploads stored as Base64 in localStorage. Use Export to backup.</div></div></div></main><footer class="footer">© <span id="yr"></span> GeniusNovels — Admin</footer><script src="data/novels.js"></script><script src="script.js"></script><script>const ADMIN_SESSION='geniusnovels_admin_session_v1';if(!localStorage.getItem(ADMIN_SESSION)){window.location.href='login.html';}document.getElementById('yr').textContent=new Date().getFullYear();const form=document.getElementById('novelForm');const coverFile=document.getElementById('coverFile');const coverUrl=document.getElementById('coverUrl');const adminList=document.getElementById('adminList');const formMsg=document.getElementById('formMsg');const novelIdInput=document.getElementById('novelId');function renderAdminList(){const local=window.GENIUS.getLocalHelpers();adminList.innerHTML='';if(local.length===0){adminList.innerHTML='<div class="small">No local novels yet.</div>';return;}local.forEach(n=>{const d=document.createElement('div');d.style.marginBottom='10px';d.style.padding='8px';d.style.border='1px solid rgba(255,255,255,0.03)';d.style.borderRadius='8px';d.innerHTML=`<strong>${n.title}</strong><div class="small">${n.genre} • ${n.pages} pages</div><div style="margin-top:8px"><button data-id="${n.id}" class="editBtn btn" style="background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--muted)">Edit</button> <button data-id="${n.id}" class="delBtn btn" style="background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--muted)">Delete</button></div>`;adminList.appendChild(d);});Array.from(adminList.querySelectorAll('.editBtn')).forEach(b=>b.addEventListener('click',()=>{const id=b.getAttribute('data-id');const item=window.GENIUS.getLocalHelpers().find(x=>x.id===id);if(item){document.getElementById('title').value=item.title;document.getElementById('genre').value=item.genre;document.getElementById('pages').value=item.pages;document.getElementById('coverUrl').value=item.cover.startsWith('data:')?'':item.cover;document.getElementById('desc').value=item.desc;novelIdInput.value=item.id;formMsg.textContent='Editing local novel. Hit Save to update.';window.scrollTo({top:0,behavior:'smooth'});}}));Array.from(adminList.querySelectorAll('.delBtn')).forEach(b=>b.addEventListener('click',()=>{const id=b.getAttribute('data-id');if(confirm('Delete this novel from local storage?')){window.GENIUS.deleteLocal(id);renderAdminList();alert('Deleted.');}}));}function readFileAsDataURL(file){return new Promise((res,rej)=>{const fr=new FileReader();fr.onload=()=>res(fr.result);fr.onerror=rej;fr.readAsDataURL(file);});}form.addEventListener('submit',async(e)=>{e.preventDefault();formMsg.textContent='Saving...';let cover=coverUrl.value.trim();if(coverFile.files && coverFile.files[0]){cover=await readFileAsDataURL(coverFile.files[0]);}const id=novelIdInput.value || 'local_' + Date.now().toString(36);const novel={id,title:document.getElementById('title').value.trim(),genre:document.getElementById('genre').value.trim(),pages:Number(document.getElementById('pages').value)||0,cover:cover||'https://images.unsplash.com/photo-1519125323398-675f0ddb6308?auto=format&fit=crop&w=900&q=80',desc:document.getElementById('desc').value.trim(),chapters:[]};if(novelIdInput.value){window.GENIUS.updateLocal(id,novel);formMsg.textContent='Updated.';}else{window.GENIUS.addLocal(novel);formMsg.textContent='Added.';}novelIdInput.value='';form.reset();renderAdminList();populateNovelSelect();});document.getElementById('resetBtn').addEventListener('click',()=>{form.reset();novelIdInput.value='';formMsg.textContent='';});document.getElementById('exportBtn').addEventListener('click',()=>{window.GENIUS.exportAll();});document.getElementById('clearBtn').addEventListener('click',()=>{if(confirm('Clear all local novels? This cannot be undone.')){localStorage.removeItem('geniusnovels_local_v1');renderAdminList();populateNovelSelect();alert('Cleared.');}});document.getElementById('logoutBtn').addEventListener('click',(e)=>{e.preventDefault();localStorage.removeItem(ADMIN_SESSION);window.location.href='login.html';});renderAdminList();function populateNovelSelect(){const sel=document.getElementById('novelSelect');sel.innerHTML='';const all=merged();all.forEach(n=>{const o=document.createElement('option');o.value=n.id;o.textContent=n.title;sel.appendChild(o);});}populateNovelSelect();const chapterForm=document.getElementById('chapterForm');chapterForm.addEventListener('submit',async(e)=>{e.preventDefault();const novelId=document.getElementById('novelSelect').value;const chTitle=document.getElementById('chTitle').value.trim();const chContent=document.getElementById('chContent').value.trim();if(!chTitle||!chContent){document.getElementById('chMsg').textContent='Provide title and content';return;} // attach chapter to local novel if exists, else create local novel stub
let local = window.GENIUS.getLocalHelpers();let target = local.find(x=>x.id===novelId); if(!target){ // copy base novel from defaults and save as local
  const base = merged().find(x=>x.id===novelId) || {id:novelId,title:'Untitled',genre:'Misc',pages:0,cover:'',desc:'',chapters:[]};
  target = Object.assign({}, base); target.chapters = target.chapters ? target.chapters.slice() : []; local.unshift(target);
} const cid = 'ch_' + Date.now().toString(36); target.chapters.push({cid:titleCase(cid), title: chTitle, content: chContent}); // update local storage
local = local.filter((v,i,arr)=>arr.findIndex(x=>x.id===v.id)===i); localStorage.setItem('geniusnovels_local_v1', JSON.stringify(local)); document.getElementById('chMsg').textContent='Chapter added.'; renderAdminList(); populateNovelSelect(); chapterForm.reset(); }); function titleCase(s){ return s.replace(/_/g,' ').replace(/\b\w/g,c=>c.toUpperCase()); }</script></body></html>